<!DOCTYPE html>
<html lang="en">
{% include 'header.html' %}
<body>
<div id="segment_id">
    {% include 'menu.html' %}
    <div class="ui grid">
        <div class="ui column" style="width: 75px; padding-top: 50px;">
            {% include 'project/sidebar.html' %}
        </div>
        <script>

            function copyToClipboard() {
                const el = document.createElement('textarea');
                el.value = $('#nmap_cmd')[0].value;
                el.setAttribute('readonly', '');
                el.style.position = 'absolute';
                el.style.left = '-9999px';
                document.body.appendChild(el);
                el.select();
                document.execCommand('copy');
                document.body.removeChild(el);
                $('body')
                    .toast({
                        class: 'success',
                        position: 'bottom right',
                        message: 'Copied!'
                    });
            };

            function cmd_builder() {
                var nmap_cmd = 'nmap';

                //discovery page
                if ($('#disc_type')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' ' + $('#disc_type')[0].value.split(" ").join("");
                }
                if ($('#disable_port_scan')[0].checked) {
                    nmap_cmd += ' -sn';
                }
                if ($('#pe_scan')[0].checked) {
                    nmap_cmd += ' -PE';
                }
                if ($('#pp_scan')[0].checked) {
                    nmap_cmd += ' -PP';
                }
                if ($('#pm_scan')[0].checked) {
                    nmap_cmd += ' -PM';
                }
                if ($('#arp')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' ' + $('#arp')[0].value.split(" ").join("");
                }
                if ($('#ps_scan')[0].checked) {
                    nmap_cmd += ' -PS' + $('#PS_ports')[0].value.split(" ").join("");
                }
                if ($('#pa_scan')[0].checked) {
                    nmap_cmd += ' -PA' + $('#PA_ports')[0].value.split(" ").join("");
                }
                if ($('#pu_scan')[0].checked) {
                    nmap_cmd += ' -PU' + $('#PU_ports')[0].value.split(" ").join("");
                }
                if ($('#py_scan')[0].checked) {
                    nmap_cmd += ' -PY' + $('#PY_ports')[0].value.split(" ").join("");
                }
                if ($('#po_scan')[0].checked) {
                    nmap_cmd += ' -PO' + $('#PO_protocols')[0].value.split(" ").join("");
                }
                if ($('#traceroute')[0].checked) {
                    nmap_cmd += ' --traceroute';
                }
                if ($('#ipv6')[0].checked) {
                    nmap_cmd += ' -6';
                }
                if ($('#dns_resolution')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' ' + $('#dns_resolution')[0].value.split(" ").join("");
                }

                if ($('#dns_servers')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --dns-servers "' + $('#dns_servers')[0].value.split(" ").join("") + '"';
                } else if ($('#system_dns')[0].checked) {
                    nmap_cmd += ' --system-dns';
                }

                //ports tab
                tcp_scan = $('#tcp_scan')[0].value.split(" ").join("");
                tcp_args = $('#tcp_args')[0].value.split(" ").join("");
                if (tcp_scan !== '') {
                    nmap_cmd += ' ' + tcp_scan;
                }
                if ((tcp_scan === '-b' || tcp_scan === '-sI') && tcp_args !== '') {
                    nmap_cmd += ' "' + tcp_args + '"';
                }

                if ($('#sctp_scan')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' ' + $('#sctp_scan')[0].value.split(" ").join("");
                }
                if ($('#udp_scan')[0].checked) {
                    nmap_cmd += ' -sU';
                }
                if ($('#no_random')[0].checked) {
                    nmap_cmd += ' -r';
                }
                if ($('#top_ports')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --top-ports ' + $('#top_ports')[0].value.split(" ").join("");
                }
                if ($('#port_ratio')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --port-ratio ' + $('#port_ratio')[0].value.split(" ").join("");
                }

                port_str = '';
                if ($('#tcp_ports')[0].value.split(" ").join("") !== '') {
                    port_str += 'T:' + $('#tcp_ports')[0].value.split(" ").join("")
                }
                if ($('#udp_ports')[0].value.split(" ").join("") !== '') {
                    if (port_str !== '') {
                        port_str += ',';
                    }
                    port_str += 'U:' + $('#udp_ports')[0].value.split(" ").join("")
                }
                if ($('#sctp_ports')[0].value.split(" ").join("") !== '') {
                    if (port_str !== '') {
                        port_str += ',';
                    }
                    port_str += 'S:' + $('#sctp_ports')[0].value.split(" ").join("")
                }
                if (port_str !== '') {
                    nmap_cmd += ' -p' + port_str;
                }

                exclude_port_str = '';
                if ($('#tcp_ports_exclude')[0].value.split(" ").join("") !== '') {
                    exclude_port_str += 'T:' + $('#tcp_ports_exclude')[0].value.split(" ").join("")
                }
                if ($('#udp_ports_exclude')[0].value.split(" ").join("") !== '') {
                    if (exclude_port_str !== '') {
                        exclude_port_str += ',';
                    }
                    exclude_port_str += 'U:' + $('#udp_ports_exclude')[0].value.split(" ").join("")
                }
                if ($('#sctp_ports_exclude')[0].value.split(" ").join("") !== '') {
                    if (exclude_port_str !== '') {
                        exclude_port_str += ',';
                    }
                    exclude_port_str += 'S:' + $('#sctp_ports_exclude')[0].value.split(" ").join("")
                }
                if (exclude_port_str !== '') {
                    nmap_cmd += ' --exclude-ports ' + exclude_port_str;
                }

                //scripts page
                nmap_scripts_str = ''
                for (i = 0; i < nmap_scripts.length; i++) {
                    if (nmap_scripts[i]['checked']) {
                        if (nmap_scripts_str !== '') {
                            nmap_scripts_str += ',';
                        }
                        nmap_scripts_str += nmap_scripts[i]["script"];
                    }
                }
                if (nmap_scripts_str !== '') {
                    nmap_cmd += ' --script "' + nmap_scripts_str + '"';
                }

                if ($('#scripts_str')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --script "' + $('#scripts_str')[0].value.split(" ").join("") + '"';
                }
                if ($('#scripts_args')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --script-args "' + $('#scripts_args')[0].value.split(" ").join("") + '"';
                }
                if ($('#scripts_args_file')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --script-args-file "' + $('#scripts_args_file')[0].value.split(" ").join("") + '"';
                }
                if ($('#update_database')[0].checked) {
                    nmap_cmd += ' --script-updatedb';
                }
                if ($('#trace_scripts')[0].checked) {
                    nmap_cmd += ' --script-trace';
                }
                if ($('#services_version')[0].checked) {
                    nmap_cmd += ' -sV';
                    if ($('#service_intensity')[0].value.split(" ").join("") !== '') {
                        nmap_cmd += ' --version-intensity ' + $('#service_intensity')[0].value.split(" ").join("");
                    }
                    if ($('#services_trace')[0].checked) {
                        nmap_cmd += ' --version-trace';
                    }
                }
                if ($('#os_detection')[0].checked) {
                    nmap_cmd += ' -O';
                    if ($('#os_limit')[0].checked) {
                        nmap_cmd += ' --osscan-limit';
                    }
                    if ($('#os_guess')[0].checked) {
                        nmap_cmd += ' --osscan-guess';
                    }
                }


                //speed
                if ($('#speed_scan')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' ' + $('#speed_scan')[0].value.split(" ").join("");
                }
                if ($('#min_hostgroup')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --min-hostgroup ' + $('#min_hostgroup')[0].value.split(" ").join("");
                }
                if ($('#max_hostgroup')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --max-hostgroup ' + $('#max_hostgroup')[0].value.split(" ").join("");
                }
                if ($('#min_parallelism')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --min-parallelism ' + $('#min_parallelism')[0].value.split(" ").join("");
                }
                if ($('#max_parallelism')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --max-parallelism ' + $('#max_parallelism')[0].value.split(" ").join("");
                }
                if ($('#min_rtt_timeout')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --min-rtt-timeout "' + $('#min_rtt_timeout')[0].value.split(" ").join("") + '"';
                }
                if ($('#max_rtt_timeout')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --max-rtt-timeout "' + $('#max_rtt_timeout')[0].value.split(" ").join("") + '"';
                }
                if ($('#init_rtt_timeout')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --init-rtt-timeout "' + $('#init_rtt_timeout')[0].value.split(" ").join("") + '"';
                }
                if ($('#max_retries')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --max-retries ' + $('#max_retries')[0].value.split(" ").join("");
                }
                if ($('#host_timeout')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --host-timeout "' + $('#host_timeout')[0].value.split(" ").join("") + '"';
                }
                if ($('#scan_delay')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --scan-delay "' + $('#scan_delay')[0].value.split(" ").join("") + '"';
                }
                if ($('#max_scan_delay')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --max-scan-delay "' + $('#max_scan_delay')[0].value.split(" ").join("") + '"';
                }
                if ($('#min_rate')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --min-rate ' + $('#min_rate')[0].value.split(" ").join("");
                }
                if ($('#max_rate')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --max-rate ' + $('#max_rate')[0].value.split(" ").join("");
                }

                //firewall tab
                if ($('#append_mode')[0].value.split(" ").join("") !== '' && $('#append_data')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' ' + $('#append_mode')[0].value.split(" ").join("") + ' "'
                        + $('#append_data')[0].value.split(" ").join("") + '"';
                }
                if ($('#ttl')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += " --ttl " + $('#ttl')[0].value.split(" ").join("");
                }
                if ($('#ip_options')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += " --ip-options '" + $('#ip_options')[0].value.split(" ").join("") + "'";
                }
                if ($('#mac')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --spoof-mac "' + $('#mac')[0].value.split(" ").join("") + '"';
                }
                if ($('#proxies')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --proxies "' + $('#proxies')[0].value.split(" ").join("") + '"';
                }
                if ($('#badsum')[0].checked) {
                    nmap_cmd += ' --badsum';
                }
                if ($('#fragment')[0].checked) {
                    nmap_cmd += ' -f';
                    if ($('#mtu')[0].value.split(" ").join("") !== '') {
                        nmap_cmd += ' --mtu ' + $('#mtu')[0].value.split(" ").join("");
                    }
                }
                if ($('#decoy')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' -D' + $('#decoy')[0].value.split(" ").join("");
                }
                if ($('#spoof_ip')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' -S "' + $('#spoof_ip')[0].value.split(" ").join("") + '"';
                }
                if ($('#interface')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' -e "' + $('#interface')[0].value.split(" ").join("") + '"';
                }
                if ($('#source_port')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' -g ' + $('#source_port')[0].value.split(" ").join("");
                }


                //output tab
                if ($('#normal_out')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' -oN "' + $('#normal_out')[0].value.split(" ").join("") + '"';
                }
                if ($('#xml_out')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' -oX "' + $('#xml_out')[0].value.split(" ").join("") + '"';
                }
                if ($('#scriptkiddie_out')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' -oS "' + $('#scriptkiddie_out')[0].value.split(" ").join("") + '"';
                }
                if ($('#grep_out')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' -oG "' + $('#grep_out')[0].value.split(" ").join("") + '"';
                }
                if ($('#all_out')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' -oA "' + $('#all_out')[0].value.split(" ").join("") + '"';
                }
                if ($('#resume')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --resume "' + $('#resume')[0].value.split(" ").join("") + '"';
                }
                if ($('#stylesheet')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --stylesheet "' + $('#stylesheet')[0].value.split(" ").join("") + '"';
                }
                if ($('#webxml')[0].checked) {
                    nmap_cmd += ' --webxml';
                }
                if ($('#nostyle')[0].checked) {
                    nmap_cmd += ' --no-stylesheet';
                }
                if ($('#verbose')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' ' + $('#verbose')[0].value.split(" ").join("");
                }
                if ($('#debug')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' ' + $('#debug')[0].value.split(" ").join("");
                }
                if ($('#reason')[0].checked) {
                    nmap_cmd += ' --reason';
                }
                if ($('#open')[0].checked) {
                    nmap_cmd += ' --open';
                }
                if ($('#trace')[0].checked) {
                    nmap_cmd += ' --packet-trace';
                }
                if ($('#iflist')[0].checked) {
                    nmap_cmd += ' --iflist';
                }
                if ($('#append_out')[0].checked) {
                    nmap_cmd += ' --append-output';
                }
                if ($('#version')[0].checked) {
                    nmap_cmd += ' -V';
                }
                if ($('#help')[0].checked) {
                    nmap_cmd += ' -h';
                }


                //hosts page
                if ($('#include_file_hosts')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' -iL "' + $('#include_file_hosts')[0].value.split(" ").join("") + '"';
                }
                if ($('#random_targets')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' -iR ' + $('#random_targets')[0].value.split(" ").join("");
                }
                if ($('#hosts_exclude')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --exclude "' + $('#hosts_exclude')[0].value.split(" ").join("") + '"';
                }
                if ($('#exclude_file_hosts')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' --excludefile "' + $('#exclude_file_hosts')[0].value.split(" ").join("") + '"';
                }
                excluded_hosts_str = ''
                for (i = 0; i < excluded_hosts.length; i++) {
                    if (excluded_hosts[i]['checked']) {
                        if (excluded_hosts_str !== '') {
                            excluded_hosts_str += ',';
                        }
                        excluded_hosts_str += excluded_hosts[i]["host"];
                    }
                }

                for (i = 0; i < excluded_networks.length; i++) {
                    if (excluded_networks[i]['checked']) {
                        if (excluded_hosts_str !== '') {
                            excluded_hosts_str += ',';
                        }
                        excluded_hosts_str += excluded_networks[i]["network"];
                    }
                }

                if (excluded_hosts_str !== '') {
                    nmap_cmd += ' --exclude "' + excluded_hosts_str + '"';
                }

                for (i = 0; i < included_hosts.length; i++) {
                    if (included_hosts[i]["checked"]) {
                        nmap_cmd += ' ' + included_hosts[i]["host"];
                    }
                }
                for (i = 0; i < included_networks.length; i++) {
                    if (included_networks[i]["checked"]) {
                        nmap_cmd += ' ' + included_networks[i]["network"];
                    }
                }
                if ($('#hosts')[0].value.split(" ").join("") !== '') {
                    nmap_cmd += ' ' + $('#hosts')[0].value;
                }

                $('#nmap_cmd')[0].value = nmap_cmd;

            }


            function list_hosts_import(list_hosts, search_field) {
                list_elem = $('#hosts-include-list')[0];
                list_elem.innerHTML = '';
                var text_html = '';
                var shown_html = '';
                var count = 0;
                for (var i = 0; i < list_hosts.length; i++) {
                    s = list_hosts[i]['host'];
                    check_str = '';
                    if (list_hosts[i]['checked']) {
                        check_str = 'checked';
                    }
                    if (s.includes(search_field.toLowerCase()) || search_field === '') {

                        inner = `<div class="ui item checkbox" data-value="item1" id="host_row">
                                <input type="checkbox" value="${list_hosts[i]['id']}" ${check_str} onchange="switch_included_host('${list_hosts[i]["id"]}');">
                                <label>${s}</label>
                            </div>`;
                        if (list_hosts[i]['checked']) {
                            shown_html += inner;
                        } else {
                            text_html += inner;
                            count += 1;
                        }
                    } else if (list_hosts[i]['checked']) {
                        inner = `<div class="ui item checkbox" data-value="item1" id="host_row" style="display: none;">
                                <input type="checkbox" value="${list_hosts[i]['id']}" checked onchange="switch_included_host('${list_hosts[i]["id"]}');">
                                <label>${s}</label>
                            </div>`;
                        shown_html += inner;
                    }
                }
                if (count > 1000) {
                    text_html = shown_html + `<div class="ui item" data-value="item1" id="host_row">
                                <label>Too much results (${count})..</label>
                            </div>`;
                }
                list_elem.innerHTML += shown_html + text_html;

                $('#host_row').checkbox();
                $('.ui.checkbox').checkbox();

            }

            function list_hosts_exclude(list_hosts, search_field) {
                list_elem = $('#hosts-export-list')[0];
                list_elem.innerHTML = '';
                var text_html = '';
                var shown_html = '';
                var count = 0;
                for (var i = 0; i < list_hosts.length; i++) {
                    s = list_hosts[i]['host'];
                    check_str = '';
                    if (list_hosts[i]['checked']) {
                        check_str = 'checked';
                    }
                    if (s.includes(search_field.toLowerCase()) || search_field === '') {

                        inner = `<div class="ui item checkbox" data-value="item1" id="host_row">
                                <input type="checkbox" value="${list_hosts[i]['id']}" ${check_str} onchange="switch_excluded_host('${list_hosts[i]["id"]}');">
                                <label>${s}</label>
                            </div>`;
                        if (list_hosts[i]['checked']) {
                            shown_html += inner;
                        } else {
                            text_html += inner;
                            count += 1;
                        }
                    } else if (list_hosts[i]['checked']) {
                        inner = `<div class="ui item checkbox" data-value="item1" id="host_row" style="display: none;">
                                <input type="checkbox" value="${list_hosts[i]['id']}" checked onchange="switch_excluded_host('${list_hosts[i]["id"]}');">
                                <label>${s}</label>
                            </div>`;
                        shown_html += inner;
                    }
                }
                if (count > 1000) {
                    text_html = shown_html + `<div class="ui item" data-value="item1" id="host_row">
                                <label>Too much results (${count})..</label>
                            </div>`;
                }
                list_elem.innerHTML += shown_html + text_html;

                $('#host_row').checkbox();
                $('.ui.checkbox').checkbox();

            }

            function list_networks_import(list_networks, search_field) {
                list_elem = $('#networks-include-list')[0];
                list_elem.innerHTML = '';
                var text_html = '';
                var shown_html = '';
                var count = 0;
                for (var i = 0; i < list_networks.length; i++) {
                    s = list_networks[i]['network'];
                    check_str = '';
                    if (list_networks[i]['checked']) {
                        check_str = 'checked';
                    }
                    if (s.includes(search_field.toLowerCase()) || search_field === '') {

                        inner = `<div class="ui item checkbox" data-value="item1" id="network_row">
                                <input type="checkbox" value="${list_networks[i]['network']}" ${check_str} onchange="switch_network_include('${list_networks[i]["network"]}');">
                                <label>${s}</label>
                            </div>`;
                        if (list_networks[i]['checked']) {
                            shown_html += inner;
                        } else {
                            text_html += inner;
                            count += 1;
                        }
                    } else if (list_networks[i]['checked']) {
                        inner = `<div class="ui item checkbox" data-value="item1" id="network_row" style="display: none;">
                                <input type="checkbox" value="${list_networks[i]['network']}" checked onchange="switch_network_include('${list_networks[i]["network"]}');">
                                <label>${s}</label>
                            </div>`;
                        shown_html += inner;
                    }
                }
                if (count > 1000) {
                    text_html = shown_html + `<div class="ui item" data-value="item1" id="network_row">
                                <label>Too much results (${count})..</label>
                            </div>`;
                }
                list_elem.innerHTML += shown_html + text_html;

                $('#network_row').checkbox();
                $('.ui.checkbox').checkbox();

            }

            function list_networks_exclude(list_networks, search_field) {
                list_elem = $('#networks-exclude-list')[0];
                list_elem.innerHTML = '';
                var text_html = '';
                var shown_html = '';
                var count = 0;
                for (var i = 0; i < list_networks.length; i++) {
                    s = list_networks[i]['network'];
                    check_str = '';
                    if (list_networks[i]['checked']) {
                        check_str = 'checked';
                    }
                    if (s.includes(search_field.toLowerCase()) || search_field === '') {

                        inner = `<div class="ui item checkbox" data-value="item1" id="network_row">
                                <input type="checkbox" value="${list_networks[i]['network']}" ${check_str} onchange="switch_network_exclude('${list_networks[i]["network"]}');">
                                <label>${s}</label>
                            </div>`;
                        if (list_networks[i]['checked']) {
                            shown_html += inner;
                        } else {
                            text_html += inner;
                            count += 1;
                        }
                    } else if (list_networks[i]['checked']) {
                        inner = `<div class="ui item checkbox" data-value="item1" id="network_row" style="display: none;">
                                <input type="checkbox" value="${list_networks[i]['network']}" checked onchange="switch_network_exclude('${list_networks[i]["network"]}');">
                                <label>${s}</label>
                            </div>`;
                        shown_html += inner;
                    }
                }
                if (count > 1000) {
                    text_html = shown_html + `<div class="ui item" data-value="item1" id="network_row">
                                <label>Too much results (${count})..</label>
                            </div>`;
                }
                list_elem.innerHTML += shown_html + text_html;

                $('#network_row').checkbox();
                $('.ui.checkbox').checkbox();

            }


            function list_scripts(scripts_list, search_field) {
                list_elem = $('#nmap-scripts-list')[0];
                list_elem.innerHTML = '';
                var text_html = '';
                var shown_html = '';
                var count = 0;
                for (var i = 0; i < scripts_list.length; i++) {
                    s = scripts_list[i]['script'];
                    check_str = '';
                    if (scripts_list[i]['checked']) {
                        check_str = 'checked';
                    }
                    if (s.includes(search_field.toLowerCase()) || search_field === '') {

                        inner = `<div class="ui item checkbox" data-value="item1" id="scripts_row">
                                <input type="checkbox" value="${scripts_list[i]['script']}" ${check_str} onchange="switch_nmap_scripts('${scripts_list[i]["script"]}');">
                                <label>${s}</label>
                            </div>`;
                        if (scripts_list[i]['checked']) {
                            shown_html += inner;
                        } else {
                            text_html += inner;
                            count += 1;
                        }
                    } else if (scripts_list[i]['checked']) {
                        inner = `<div class="ui item checkbox" data-value="item1" id="scripts_row" style="display: none;">
                                <input type="checkbox" value="${scripts_list[i]['script']}" checked onchange="switch_nmap_scripts('${scripts_list[i]["script"]}');">
                                <label>${s}</label>
                            </div>`;
                        shown_html += inner;
                    }
                }
                if (count > 1000) {
                    text_html = shown_html + `<div class="ui item" data-value="item1" id="scripts_row">
                                <label>Too much results (${count})..</label>
                            </div>`;
                }
                list_elem.innerHTML += shown_html + text_html;

                $('#scripts_row').checkbox();
                $('.ui.checkbox').checkbox();
            }

            var included_hosts = [];
            var included_networks = [];
            var excluded_hosts = [];
            var excluded_networks = [];
            var nmap_scripts = [];

            $(document).ready(function () {
                $('#options_tabs .item').tab({
                    history: true
                });

                // get hosts list
                $.getJSON("/project/{{ current_project['id'] }}/issues/hosts_hostnames_list", function (j) {
                    included_hosts = JSON.parse(JSON.stringify(j))
                    list_hosts_import(included_hosts, '');
                    excluded_hosts = JSON.parse(JSON.stringify(j))
                    list_hosts_exclude(excluded_hosts, '');

                });

                $.getJSON("/project/{{ current_project['id'] }}/issues/networks_list", function (j) {
                    included_networks = JSON.parse(JSON.stringify(j));
                    list_networks_import(included_networks, '');

                    excluded_networks = JSON.parse(JSON.stringify(j));
                    list_networks_exclude(excluded_networks, '');
                });

                nmap_scripts = [{"script": "acarsd-info"}, {"script": "dns-random-srcport"}, {"script": "http-hp-ilo-info"}, {"script": "ip-geolocation-ipinfodb"}, {"script": "ntp-info"}, {"script": "smtp-enum-users"}, {"script": "address-info"}, {"script": "dns-random-txid"}, {"script": "http-huawei-hg5xx-vuln"}, {"script": "ip-geolocation-map-bing"}, {"script": "ntp-monlist"}, {"script": "smtp-ntlm-info"}, {"script": "afp-brute"}, {"script": "dns-recursion"}, {"script": "http-icloud-findmyiphone"}, {"script": "ip-geolocation-map-google"}, {"script": "omp2-brute"}, {"script": "smtp-open-relay"}, {"script": "afp-ls"}, {"script": "dns-service-discovery"}, {"script": "http-icloud-sendmsg"}, {"script": "ip-geolocation-map-kml"}, {"script": "omp2-enum-targets"}, {"script": "smtp-strangeport"}, {"script": "afp-path-vuln"}, {"script": "dns-srv-enum"}, {"script": "http-iis-short-name-brute"}, {"script": "ip-geolocation-maxmind"}, {"script": "omron-info"}, {"script": "smtp-vuln-cve2010-4344"}, {"script": "afp-serverinfo"}, {"script": "dns-update"}, {"script": "http-iis-webdav-vuln"}, {"script": "ip-https-discover"}, {"script": "openlookup-info"}, {"script": "smtp-vuln-cve2011-1720"}, {"script": "afp-showmount"}, {"script": "dns-zeustracker"}, {"script": "http-internal-ip-disclosure"}, {"script": "ipidseq"}, {"script": "openvas-otp-brute"}, {"script": "smtp-vuln-cve2011-1764"}, {"script": "ajp-auth"}, {"script": "dns-zone-transfer"}, {"script": "http-joomla-brute"}, {"script": "ipmi-brute"}, {"script": "openwebnet-discovery"}, {"script": "sniffer-detect"}, {"script": "ajp-brute"}, {"script": "docker-version"}, {"script": "http-jsonp-detection"}, {"script": "ipmi-cipher-zero"}, {"script": "oracle-brute"}, {"script": "snmp-brute"}, {"script": "ajp-headers"}, {"script": "domcon-brute"}, {"script": "http-litespeed-sourcecode-download"}, {"script": "ipmi-version"}, {"script": "oracle-brute-stealth"}, {"script": "snmp-hh3c-logins"}, {"script": "ajp-methods"}, {"script": "domcon-cmd"}, {"script": "http-ls"}, {"script": "ipv6-multicast-mld-list"}, {"script": "oracle-enum-users"}, {"script": "snmp-info"}, {"script": "ajp-request"}, {"script": "domino-enum-users"}, {"script": "http-majordomo2-dir-traversal"}, {"script": "ipv6-node-info"}, {"script": "oracle-sid-brute"}, {"script": "snmp-interfaces"}, {"script": "allseeingeye-info"}, {"script": "dpap-brute"}, {"script": "http-malware-host"}, {"script": "ipv6-ra-flood"}, {"script": "oracle-tns-version"}, {"script": "snmp-ios-config"}, {"script": "amqp-info"}, {"script": "drda-brute"}, {"script": "http-mcmp"}, {"script": "irc-botnet-channels"}, {"script": "ovs-agent-version"}, {"script": "snmp-netstat"}, {"script": "asn-query"}, {"script": "drda-info"}, {"script": "http-methods"}, {"script": "irc-brute"}, {"script": "p2p-conficker"}, {"script": "snmp-processes"}, {"script": "auth-owners"}, {"script": "duplicates"}, {"script": "http-method-tamper"}, {"script": "irc-info"}, {"script": "path-mtu"}, {"script": "snmp-sysdescr"}, {"script": "auth-spoof"}, {"script": "eap-info"}, {"script": "http-mobileversion-checker"}, {"script": "irc-sasl-brute"}, {"script": "pcanywhere-brute"}, {"script": "snmp-win32-services"}, {"script": "backorifice-brute"}, {"script": "enip-info"}, {"script": "http-ntlm-info"}, {"script": "irc-unrealircd-backdoor"}, {"script": "pcworx-info"}, {"script": "snmp-win32-shares"}, {"script": "backorifice-info"}, {"script": "epmd-info"}, {"script": "http-open-proxy"}, {"script": "iscsi-brute"}, {"script": "pgsql-brute"}, {"script": "snmp-win32-software"}, {"script": "bacnet-info"}, {"script": "eppc-enum-processes"}, {"script": "http-open-redirect"}, {"script": "iscsi-info"}, {"script": "pjl-ready-message"}, {"script": "snmp-win32-users"}, {"script": "banner"}, {"script": "fcrdns"}, {"script": "http-passwd"}, {"script": "isns-info"}, {"script": "pop3-brute"}, {"script": "socks-auth-info"}, {"script": "bitcoin-getaddr"}, {"script": "finger"}, {"script": "http-phpmyadmin-dir-traversal"}, {"script": "jdwp-exec"}, {"script": "pop3-capabilities"}, {"script": "socks-brute"}, {"script": "bitcoin-info"}, {"script": "fingerprint-strings"}, {"script": "http-phpself-xss"}, {"script": "jdwp-info"}, {"script": "pop3-ntlm-info"}, {"script": "socks-open-proxy"}, {"script": "bitcoinrpc-info"}, {"script": "firewalk"}, {"script": "http-php-version"}, {"script": "jdwp-inject"}, {"script": "pptp-version"}, {"script": "ssh2-enum-algos"}, {"script": "bittorrent-discovery"}, {"script": "firewall-bypass"}, {"script": "http-proxy-brute"}, {"script": "jdwp-version"}, {"script": "puppet-naivesigning"}, {"script": "ssh-auth-methods"}, {"script": "bjnp-discover"}, {"script": "flume-master-info"}, {"script": "http-put"}, {"script": "knx-gateway-discover"}, {"script": "qconn-exec"}, {"script": "ssh-brute"}, {"script": "broadcast-ataoe-discover"}, {"script": "fox-info"}, {"script": "http-qnap-nas-info"}, {"script": "knx-gateway-info"}, {"script": "qscan"}, {"script": "ssh-hostkey"}, {"script": "broadcast-avahi-dos"}, {"script": "freelancer-info"}, {"script": "http-referer-checker"}, {"script": "krb5-enum-users"}, {"script": "quake1-info"}, {"script": "ssh-publickey-acceptance"}, {"script": "broadcast-bjnp-discover"}, {"script": "ftp-anon"}, {"script": "http-rfi-spider"}, {"script": "ldap-brute"}, {"script": "quake3-info"}, {"script": "ssh-run"}, {"script": "broadcast-db2-discover"}, {"script": "ftp-bounce"}, {"script": "http-robots.txt"}, {"script": "ldap-novell-getpass"}, {"script": "quake3-master-getservers"}, {"script": "sshv1"}, {"script": "broadcast-dhcp6-discover"}, {"script": "ftp-brute"}, {"script": "http-robtex-reverse-ip"}, {"script": "ldap-rootdse"}, {"script": "rdp-enum-encryption"}, {"script": "ssl-ccs-injection"}, {"script": "broadcast-dhcp-discover"}, {"script": "ftp-libopie"}, {"script": "http-robtex-shared-ns"}, {"script": "ldap-search"}, {"script": "rdp-ntlm-info"}, {"script": "ssl-cert-intaddr"}, {"script": "broadcast-dns-service-discovery"}, {"script": "ftp-proftpd-backdoor"}, {"script": "http-sap-netweaver-leak"}, {"script": "lexmark-config"}, {"script": "rdp-vuln-ms12-020"}, {"script": "ssl-cert"}, {"script": "broadcast-dropbox-listener"}, {"script": "ftp-syst"}, {"script": "http-security-headers"}, {"script": "llmnr-resolve"}, {"script": "realvnc-auth-bypass"}, {"script": "ssl-date"}, {"script": "broadcast-eigrp-discovery"}, {"script": "ftp-vsftpd-backdoor"}, {"script": "http-server-header"}, {"script": "lltd-discovery"}, {"script": "redis-brute"}, {"script": "ssl-dh-params"}, {"script": "broadcast-hid-discoveryd"}, {"script": "ftp-vuln-cve2010-4221"}, {"script": "http-shellshock"}, {"script": "lu-enum"}, {"script": "redis-info"}, {"script": "ssl-enum-ciphers"}, {"script": "broadcast-igmp-discovery"}, {"script": "ganglia-info"}, {"script": "http-sitemap-generator"}, {"script": "maxdb-info"}, {"script": "resolveall"}, {"script": "ssl-heartbleed"}, {"script": "broadcast-jenkins-discover"}, {"script": "giop-info"}, {"script": "http-slowloris-check"}, {"script": "mcafee-epo-agent"}, {"script": "reverse-index"}, {"script": "ssl-known-key"}, {"script": "broadcast-listener"}, {"script": "gkrellm-info"}, {"script": "http-slowloris"}, {"script": "membase-brute"}, {"script": "rexec-brute"}, {"script": "ssl-poodle"}, {"script": "broadcast-ms-sql-discover"}, {"script": "gopher-ls"}, {"script": "http-sql-injection"}, {"script": "membase-http-info"}, {"script": "rfc868-time"}, {"script": "sslv2-drown"}, {"script": "broadcast-netbios-master-browser"}, {"script": "gpsd-info"}, {"script": "https-redirect"}, {"script": "memcached-info"}, {"script": "riak-http-info"}, {"script": "sslv2"}, {"script": "broadcast-networker-discover"}, {"script": "hadoop-datanode-info"}, {"script": "http-stored-xss"}, {"script": "metasploit-info"}, {"script": "rlogin-brute"}, {"script": "sstp-discover"}, {"script": "broadcast-novell-locate"}, {"script": "hadoop-jobtracker-info"}, {"script": "http-svn-enum"}, {"script": "metasploit-msgrpc-brute"}, {"script": "rmi-dumpregistry"}, {"script": "stun-info"}, {"script": "broadcast-ospf2-discover"}, {"script": "hadoop-namenode-info"}, {"script": "http-svn-info"}, {"script": "metasploit-xmlrpc-brute"}, {"script": "rmi-vuln-classloader"}, {"script": "stun-version"}, {"script": "broadcast-pc-anywhere"}, {"script": "hadoop-secondary-namenode-info"}, {"script": "http-title"}, {"script": "mikrotik-routeros-brute"}, {"script": "rpcap-brute"}, {"script": "stuxnet-detect"}, {"script": "broadcast-pc-duo"}, {"script": "hadoop-tasktracker-info"}, {"script": "http-tplink-dir-traversal"}, {"script": "mmouse-brute"}, {"script": "rpcap-info"}, {"script": "supermicro-ipmi-conf"}, {"script": "broadcast-pim-discovery"}, {"script": "hbase-master-info"}, {"script": "http-trace"}, {"script": "mmouse-exec"}, {"script": "rpc-grind"}, {"script": "svn-brute"}, {"script": "broadcast-ping"}, {"script": "hbase-region-info"}, {"script": "http-traceroute"}, {"script": "modbus-discover"}, {"script": "rpcinfo"}, {"script": "targets-asn"}, {"script": "broadcast-pppoe-discover"}, {"script": "hddtemp-info"}, {"script": "http-trane-info"}, {"script": "mongodb-brute"}, {"script": "rsa-vuln-roca"}, {"script": "targets-ipv6-map4to6"}, {"script": "broadcast-rip-discover"}, {"script": "hnap-info"}, {"script": "http-unsafe-output-escaping"}, {"script": "mongodb-databases"}, {"script": "rsync-brute"}, {"script": "targets-ipv6-multicast-echo"}, {"script": "broadcast-ripng-discover"}, {"script": "hostmap-bfk"}, {"script": "http-useragent-tester"}, {"script": "mongodb-info"}, {"script": "rsync-list-modules"}, {"script": "targets-ipv6-multicast-invalid-dst"}, {"script": "broadcast-sonicwall-discover"}, {"script": "hostmap-crtsh"}, {"script": "http-userdir-enum"}, {"script": "mqtt-subscribe"}, {"script": "rtsp-methods"}, {"script": "targets-ipv6-multicast-mld"}, {"script": "broadcast-sybase-asa-discover"}, {"script": "hostmap-robtex"}, {"script": "http-vhosts"}, {"script": "mrinfo"}, {"script": "rtsp-url-brute"}, {"script": "targets-ipv6-multicast-slaac"}, {"script": "broadcast-tellstick-discover"}, {"script": "http-adobe-coldfusion-apsa1301"}, {"script": "http-virustotal"}, {"script": "msrpc-enum"}, {"script": "rusers"}, {"script": "targets-ipv6-wordlist"}, {"script": "broadcast-upnp-info"}, {"script": "http-affiliate-id"}, {"script": "http-vlcstreamer-ls"}, {"script": "ms-sql-brute"}, {"script": "s7-info"}, {"script": "targets-sniffer"}, {"script": "broadcast-versant-locate"}, {"script": "http-apache-negotiation"}, {"script": "http-vmware-path-vuln"}, {"script": "ms-sql-config"}, {"script": "samba-vuln-cve-2012-1182"}, {"script": "targets-traceroute"}, {"script": "broadcast-wake-on-lan"}, {"script": "http-apache-server-status"}, {"script": "http-vuln-cve2006-3392"}, {"script": "ms-sql-dac"}, {"script": "script.db"}, {"script": "targets-xml"}, {"script": "broadcast-wpad-discover"}, {"script": "http-aspnet-debug"}, {"script": "http-vuln-cve2009-3960"}, {"script": "ms-sql-dump-hashes"}, {"script": "servicetags"}, {"script": "teamspeak2-version"}, {"script": "broadcast-wsdd-discover"}, {"script": "http-auth-finder"}, {"script": "http-vuln-cve2010-0738"}, {"script": "ms-sql-empty-password"}, {"script": "shodan-api"}, {"script": "telnet-brute"}, {"script": "broadcast-xdmcp-discover"}, {"script": "http-auth"}, {"script": "http-vuln-cve2010-2861"}, {"script": "ms-sql-hasdbaccess"}, {"script": "sip-brute"}, {"script": "telnet-encryption"}, {"script": "cassandra-brute"}, {"script": "http-avaya-ipoffice-users"}, {"script": "http-vuln-cve2011-3192"}, {"script": "ms-sql-info"}, {"script": "sip-call-spoof"}, {"script": "telnet-ntlm-info"}, {"script": "cassandra-info"}, {"script": "http-awstatstotals-exec"}, {"script": "http-vuln-cve2011-3368"}, {"script": "ms-sql-ntlm-info"}, {"script": "sip-enum-users"}, {"script": "tftp-enum"}, {"script": "cccam-version"}, {"script": "http-axis2-dir-traversal"}, {"script": "http-vuln-cve2012-1823"}, {"script": "ms-sql-query"}, {"script": "sip-methods"}, {"script": "tls-alpn"}, {"script": "cics-enum"}, {"script": "http-backup-finder"}, {"script": "http-vuln-cve2013-0156"}, {"script": "ms-sql-tables"}, {"script": "skypev2-version"}, {"script": "tls-nextprotoneg"}, {"script": "cics-info"}, {"script": "http-barracuda-dir-traversal"}, {"script": "http-vuln-cve2013-6786"}, {"script": "ms-sql-xp-cmdshell"}, {"script": "smb2-capabilities"}, {"script": "tls-ticketbleed"}, {"script": "cics-user-brute"}, {"script": "http-bigip-cookie"}, {"script": "http-vuln-cve2013-7091"}, {"script": "mtrace"}, {"script": "smb2-security-mode"}, {"script": "tn3270-screen"}, {"script": "cics-user-enum"}, {"script": "http-brute"}, {"script": "http-vuln-cve2014-2126"}, {"script": "murmur-version"}, {"script": "smb2-time"}, {"script": "tor-consensus-checker"}, {"script": "citrix-brute-xml"}, {"script": "http-cakephp-version"}, {"script": "http-vuln-cve2014-2127"}, {"script": "mysql-audit"}, {"script": "smb2-vuln-uptime"}, {"script": "traceroute-geolocation"}, {"script": "citrix-enum-apps"}, {"script": "http-chrono"}, {"script": "http-vuln-cve2014-2128"}, {"script": "mysql-brute"}, {"script": "smb-brute"}, {"script": "tso-brute"}, {"script": "citrix-enum-apps-xml"}, {"script": "http-cisco-anyconnect"}, {"script": "http-vuln-cve2014-2129"}, {"script": "mysql-databases"}, {"script": "smb-double-pulsar-backdoor"}, {"script": "tso-enum"}, {"script": "citrix-enum-servers"}, {"script": "http-coldfusion-subzero"}, {"script": "http-vuln-cve2014-3704"}, {"script": "mysql-dump-hashes"}, {"script": "smb-enum-domains"}, {"script": "ubiquiti-discovery"}, {"script": "citrix-enum-servers-xml"}, {"script": "http-comments-displayer"}, {"script": "http-vuln-cve2014-8877"}, {"script": "mysql-empty-password"}, {"script": "smb-enum-groups"}, {"script": "unittest"}, {"script": "clamav-exec"}, {"script": "http-config-backup"}, {"script": "http-vuln-cve2015-1427"}, {"script": "mysql-enum"}, {"script": "smb-enum-processes"}, {"script": "unusual-port"}, {"script": "clock-skew"}, {"script": "http-cookie-flags"}, {"script": "http-vuln-cve2015-1635"}, {"script": "mysql-info"}, {"script": "smb-enum-services"}, {"script": "upnp-info"}, {"script": "coap-resources"}, {"script": "http-cors"}, {"script": "http-vuln-cve2017-1001000"}, {"script": "mysql-query"}, {"script": "smb-enum-sessions"}, {"script": "uptime-agent-info"}, {"script": "couchdb-databases"}, {"script": "http-cross-domain-policy"}, {"script": "http-vuln-cve2017-5638"}, {"script": "mysql-users"}, {"script": "smb-enum-shares"}, {"script": "url-snarf"}, {"script": "couchdb-stats"}, {"script": "http-csrf"}, {"script": "http-vuln-cve2017-5689"}, {"script": "mysql-variables"}, {"script": "smb-enum-users"}, {"script": "ventrilo-info"}, {"script": "creds-summary"}, {"script": "http-date"}, {"script": "http-vuln-cve2017-8917"}, {"script": "mysql-vuln-cve2012-2122"}, {"script": "smb-flood"}, {"script": "versant-info"}, {"script": "cups-info"}, {"script": "http-default-accounts"}, {"script": "http-vuln-misfortune-cookie"}, {"script": "nat-pmp-info"}, {"script": "smb-ls"}, {"script": "vmauthd-brute"}, {"script": "cups-queue-info"}, {"script": "http-devframework"}, {"script": "http-vuln-wnr1000-creds"}, {"script": "nat-pmp-mapport"}, {"script": "smb-mbenum"}, {"script": "vmware-version"}, {"script": "cvs-brute"}, {"script": "http-dlink-backdoor"}, {"script": "http-waf-detect"}, {"script": "nbd-info"}, {"script": "smb-os-discovery"}, {"script": "vnc-brute"}, {"script": "cvs-brute-repository"}, {"script": "http-dombased-xss"}, {"script": "http-waf-fingerprint"}, {"script": "nbstat"}, {"script": "smb-print-text"}, {"script": "vnc-info"}, {"script": "daap-get-library"}, {"script": "http-domino-enum-passwords"}, {"script": "http-webdav-scan"}, {"script": "ncp-enum-users"}, {"script": "smb-protocols"}, {"script": "vnc-title"}, {"script": "daytime"}, {"script": "http-drupal-enum"}, {"script": "http-wordpress-brute"}, {"script": "ncp-serverinfo"}, {"script": "smb-psexec"}, {"script": "voldemort-info"}, {"script": "db2-das-info"}, {"script": "http-drupal-enum-users"}, {"script": "http-wordpress-enum"}, {"script": "ndmp-fs-info"}, {"script": "smb-security-mode"}, {"script": "vtam-enum"}, {"script": "deluge-rpc-brute"}, {"script": "http-enum"}, {"script": "http-wordpress-users"}, {"script": "ndmp-version"}, {"script": "smb-server-stats"}, {"script": "vulners"}, {"script": "dhcp-discover"}, {"script": "http-errors"}, {"script": "http-xssed"}, {"script": "nessus-brute"}, {"script": "smb-system-info"}, {"script": "vuze-dht-info"}, {"script": "dicom-brute"}, {"script": "http-exif-spider"}, {"script": "iax2-brute"}, {"script": "nessus-xmlrpc-brute"}, {"script": "smb-vuln-conficker"}, {"script": "wdb-version"}, {"script": "dicom-ping"}, {"script": "http-favicon"}, {"script": "iax2-version"}, {"script": "netbus-auth-bypass"}, {"script": "smb-vuln-cve2009-3103"}, {"script": "weblogic-t3-info"}, {"script": "dict-info"}, {"script": "http-feed"}, {"script": "icap-info"}, {"script": "netbus-brute"}, {"script": "smb-vuln-cve-2017-7494"}, {"script": "whois-domain"}, {"script": "distcc-cve2004-2687"}, {"script": "http-fetch"}, {"script": "iec-identify"}, {"script": "netbus-info"}, {"script": "smb-vuln-ms06-025"}, {"script": "whois-ip"}, {"script": "dns-blacklist"}, {"script": "http-fileupload-exploiter"}, {"script": "ike-version"}, {"script": "netbus-version"}, {"script": "smb-vuln-ms07-029"}, {"script": "wsdd-discover"}, {"script": "dns-brute"}, {"script": "http-form-brute"}, {"script": "imap-brute"}, {"script": "nexpose-brute"}, {"script": "smb-vuln-ms08-067"}, {"script": "x11-access"}, {"script": "dns-cache-snoop"}, {"script": "http-form-fuzzer"}, {"script": "imap-capabilities"}, {"script": "nfs-ls"}, {"script": "smb-vuln-ms10-054"}, {"script": "xdmcp-discover"}, {"script": "dns-check-zone"}, {"script": "http-frontpage-login"}, {"script": "imap-ntlm-info"}, {"script": "nfs-showmount"}, {"script": "smb-vuln-ms10-061"}, {"script": "xmlrpc-methods"}, {"script": "dns-client-subnet-scan"}, {"script": "http-generator"}, {"script": "impress-remote-discover"}, {"script": "nfs-statfs"}, {"script": "smb-vuln-ms17-010"}, {"script": "xmpp-brute"}, {"script": "dns-fuzz"}, {"script": "http-git"}, {"script": "informix-brute"}, {"script": "nje-node-brute"}, {"script": "smb-vuln-regsvc-dos"}, {"script": "xmpp-info"}, {"script": "dns-ip6-arpa-scan"}, {"script": "http-gitweb-projects-enum"}, {"script": "informix-query"}, {"script": "nje-pass-brute"}, {"script": "smb-vuln-webexec"}, {"script": "dns-nsec3-enum"}, {"script": "http-google-malware"}, {"script": "informix-tables"}, {"script": "nntp-ntlm-info"}, {"script": "smb-webexec-exploit"}, {"script": "dns-nsec-enum"}, {"script": "http-grep"}, {"script": "ip-forwarding"}, {"script": "nping-brute"}, {"script": "smtp-brute"}, {"script": "dns-nsid"}, {"script": "http-headers"}, {"script": "ip-geolocation-geoplugin"}, {"script": "nrpe-enum"}, {"script": "smtp-commands"}];

                list_scripts(nmap_scripts, '');


                input = $('#input_search_host_import')[0];
                input.oninput = function () {
                    value = $('#input_search_host_import')[0].value;
                    list_hosts_import(included_hosts, value);
                };

                input = $('#input_search_host_exclude')[0];
                input.oninput = function () {
                    value = $('#input_search_host_exclude')[0].value;
                    list_hosts_exclude(excluded_hosts, value);
                };

                input = $('#input_search_network_import')[0];
                input.oninput = function () {
                    value = $('#input_search_network_import')[0].value;
                    list_networks_import(included_networks, value);
                };

                input = $('#input_search_network_exclude')[0];
                input.oninput = function () {
                    value = $('#input_search_network_exclude')[0].value;
                    list_networks_exclude(excluded_networks, value);
                };

                input = $('#input_search_nmap_script')[0];
                input.oninput = function () {
                    value = $('#input_search_nmap_script')[0].value;
                    list_scripts(nmap_scripts, value);
                };

                $('.ui.dropdown').dropdown({});


                $('#generated_cmd')
                    .sticky({
                        context: '#segment_id'
                    })
                ;

                var elements = document.getElementsByClassName("nmap_param");

                for (var i = 0; i < elements.length; i++) {
                    elements[i].addEventListener('onchange', cmd_builder);
                    elements[i].addEventListener('oninput', cmd_builder);
                    elements[i].addEventListener('change', cmd_builder);
                    elements[i].addEventListener('propertychange', cmd_builder);
                    elements[i].addEventListener('oncheck', cmd_builder);
                    elements[i].addEventListener('keydown', cmd_builder);
                    elements[i].addEventListener('keyup', cmd_builder);
                }

                cmd_builder();

            });


            function switch_included_host(host_id) {
                for (var i = 0; i < included_hosts.length; i++) {
                    s = included_hosts[i]['id'];
                    if (s === host_id) {
                        included_hosts[i]['checked'] = !included_hosts[i]['checked'];
                        cmd_builder();
                        return;
                    }
                }
            }

            function switch_excluded_host(host_id) {
                for (var i = 0; i < excluded_hosts.length; i++) {
                    s = excluded_hosts[i]['id'];
                    if (s === host_id) {
                        excluded_hosts[i]['checked'] = !excluded_hosts[i]['checked'];
                        cmd_builder();
                        return;
                    }
                }
            }

            function switch_network_include(network) {
                for (var i = 0; i < included_networks.length; i++) {
                    s = included_networks[i]['network'];
                    if (s === network) {
                        included_networks[i]['checked'] = !included_networks[i]['checked'];
                        cmd_builder();
                        return;
                    }
                }
            }

            function switch_network_exclude(network) {
                for (var i = 0; i < excluded_networks.length; i++) {
                    s = excluded_networks[i]['network'];
                    if (s === network) {
                        excluded_networks[i]['checked'] = !excluded_networks[i]['checked'];
                        cmd_builder();
                        return;
                    }
                }
            }

            function switch_nmap_scripts(nmap_script) {
                for (var i = 0; i < nmap_scripts.length; i++) {
                    s = nmap_scripts[i]['script'];
                    if (s === nmap_script) {
                        nmap_scripts[i]['checked'] = !nmap_scripts[i]['checked'];
                        cmd_builder();
                        return;
                    }
                }
            }
        </script>
        <div class="ui column" style="width: calc(100% - 75px)">
            <h1 class="ui dividing header">Active Directory CheatSheet</h1>
            <div class="ui container" style="width: 90%">
                <div class="ui relaxed divided items">
                    <div class="item">
                        <div class="ui small image">
                            {% if external_img %}
                                <img src="https://miro.medium.com/v2/resize:fit:720/1*kk22SDXEt6p-mQCSlOYpcg.png">
                            {% else %}
                                <img src="https://miro.medium.com/v2/resize:fit:720/1*kk22SDXEt6p-mQCSlOYpcg.png">
                            {% endif %}
                        </div>
                        <div class="content">
                            <a class="header">Active Directory</a>
                            <div class="meta">
                                <a>Microsoft</a>
                                <a>Networking</a>
                            </div>
                            <div class="description">
                                Active Directory (AD) is a directory service developed by Microsoft for Windows domain networks.
                            </div>
                            <div class="extra">
                                <a href="https://nmap.org/" class="ui right floated purple button" target="_blank" rel="noopener noreferrer">
                                    Official site
                                    <i class="right chevron icon"></i>
                                </a>
                                <div class="ui label">Opensource</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="ui divider"></div>
                <style>
                    table{
                        width: 100%;
                    }

                    th{
                        padding: 10px;
                        border:2px solid #000000;
                    }

                    td{
                        padding: 10px;
                        border:1px solid gray;
                    }
                </style>
                <div class="ui container" style="width: 100%">
                    {{ html_code|safe }}
                </div>
            </div>
        </div>
        {% include 'footer.html' %}
    </div>
</div>
<script>
    $(document).ready(function () {


                $('table').DataTable({
                    "aaSorting": [],
                    "iDisplayLength": -1,
                    "searching": true,
                    "paging": false,
                    "info": false,
                    "order": [[0, 'asc']],
                    "padding": false,
                    'columnDefs': [
                        {
                            'targets': 0,
                            'searchable': true,
                            'orderable': false,
                        },
                        {
                            'targets': 1,
                            'searchable': true,
                            'orderable': false,
                        }]
                });

            });
</script>
</body>
</html>